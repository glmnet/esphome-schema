{
  "api": {
    "condition": {
      "connected": {
        "docs": "This [Condition](https://esphome.io/automations/actions.html#config-condition) checks if at least one client is connected to the ESPHome native API. Please note client not only includes Home Assistant, but also ESPHome\u2019s OTA log output if logs are shown remotely.\n\n*See also: [`api.connected` Condition](https://esphome.io/components/api.html#api-connected-condition)*"
      }
    },
    "schemas": {
      "ACTIONS_SCHEMA": {
        "has_required_var": true,
        "schema": {
          "config_vars": {
            "action": {
              "key": "Optional",
              "type": "string"
            },
            "service": {
              "key": "Optional",
              "type": "string"
            },
            "then": {
              "type": "trigger"
            },
            "variables": {
              "default": "{}",
              "key": "String",
              "key_type": "validate_id_name",
              "schema": {
                "config_vars": {
                  "string": {
                    "type": "enum",
                    "values": {
                      "bool": null,
                      "bool[]": null,
                      "float": null,
                      "float[]": null,
                      "int": null,
                      "int[]": null,
                      "string": null,
                      "string[]": null
                    }
                  }
                }
              },
              "type": "schema"
            }
          }
        },
        "type": "trigger"
      },
      "CONFIG_SCHEMA": {
        "schema": {
          "config_vars": {
            "actions": {
              "docs": "**, list**: A list of user-defined actions. See [User-defined Actions](https://esphome.io/components/api.html#api-device-actions).\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "schema": {
                "extends": [
                  "api.ACTIONS_SCHEMA"
                ]
              },
              "type": "schema"
            },
            "encryption": {
              "docs": "If present, encryption will be enabled for the API. Using encryption helps to secure the communication between the device running ESPHome and the connected client(s).\n  * **key** (*Optional*, string): A 32-byte base64-encoded string to be used as the encryption key. If not provided, the key may be set at runtime, but **encryption will not be used until it is set.**If you need a key, you can use the key below; it is randomly generated by your browser each time this page loads:<input type=\"text\" id=\"api-key\" onclick=\"this.focus();this.select()\" style=\"width: 350px; max-width: 75vw;\" readonly=\"readonly\"> <script>   // https://stackoverflow.com/a/62362724   function bytesArrToBase64(arr) {     const abc = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"; // base64 alphabet     const bin = n => n.toString(2).padStart(8,0); // convert num to 8-bit binary string     const l = arr.length     let result = '';      for(let i=0; i<=(l-1)/3; i++) {       let c1 = i*3+1>=l; // case when \"=\" is on end       let c2 = i*3+2>=l; // case when \"=\" is on end       let chunk = bin(arr[3*i]) + bin(c1? 0:arr[3*i+1]) + bin(c2? 0:arr[3*i+2]);       let r = chunk.match(/.{1,6}/g).map((x,j)=> j==3&&c2 ? '=' :(j==2&&c1 ? '=':abc[+('0b'+x)]));       result += r.join('');     }      return result;   }    let array = new Uint8Array(32);   window.crypto.getRandomValues(array);   document.getElementById(\"api-key\").value = bytesArrToBase64(array); </script>\n     > Support for configuring the encryption key on-the-fly will be implemented in a future release of Home Assistant.\n  \n  \n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional"
            },
            "id": {
              "docs": "**, [ID](https://esphome.io/guides/configuration-types.html#config-id)**: Manually specify the ID used for code generation.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "id_type": {
                "class": "api::APIServer",
                "parents": [
                  "Component",
                  "Controller"
                ]
              },
              "key": "GeneratedID"
            },
            "on_client_connected": {
              "docs": "**, [Action](https://esphome.io/automations/actions.html#config-action)**: An automation to perform when a client connects to the API. See [on_client_connected Trigger](https://esphome.io/components/api.html#api-on-client-connected-trigger).\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "type": "trigger"
            },
            "on_client_disconnected": {
              "docs": "**, [Action](https://esphome.io/automations/actions.html#config-action)**: An automation to perform when a client disconnects from the API. See [on_client_disconnected Trigger](https://esphome.io/components/api.html#api-on-client-disconnected-trigger).\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "type": "trigger"
            },
            "password": {
              "default": "",
              "docs": "**, **Deprecated**, string**: The password to protect the API Server with. Defaults to no password. It is recommended to use the `encryption` -> `key` above instead of the the `password`.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "type": "string"
            },
            "port": {
              "data_type": "port",
              "default": "6053",
              "docs": "**, int**: The port to run the API server on. Defaults to `6053`.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "type": "integer"
            },
            "reboot_timeout": {
              "default": "15min",
              "docs": "**, [Time](https://esphome.io/guides/configuration-types.html#config-time)**: The amount of time to wait before rebooting when no client connects to the API. This is needed because sometimes the low level ESP functions report that the ESP is connected to the network, when in fact it is not - only a full reboot fixes it. Can be disabled by setting this to `0s`. Defaults to `15min`.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#configuration-variables)*",
              "key": "Optional",
              "schema": {
                "extends": [
                  "core.positive_time_period_milliseconds"
                ]
              },
              "type": "schema"
            },
            "services": {
              "key": "Optional",
              "schema": {
                "extends": [
                  "api.ACTIONS_SCHEMA"
                ]
              },
              "type": "schema"
            }
          },
          "extends": [
            "core.COMPONENT_SCHEMA"
          ]
        },
        "type": "schema"
      },
      "HOMEASSISTANT_ACTION_ACTION_SCHEMA": {
        "schema": {
          "config_vars": {
            "action": {
              "docs": "**, string**: The Home Assistant [Action](https://www.home-assistant.io/docs/scripts/service-calls/) to perform.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#id2)*",
              "key": "Optional",
              "templatable": true,
              "type": "string"
            },
            "data": {
              "default": "{}",
              "docs": "**, mapping**: Optional *static* data to perform the action with.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#id2)*",
              "key": "Optional",
              "schema": {
                "extends": [
                  "api.KEY_VALUE_SCHEMA"
                ]
              },
              "type": "schema"
            },
            "data_template": {
              "default": "{}",
              "docs": "**, mapping**: Optional template data to perform the action with. This is evaluated on the Home Assistant side with Home Assistant\u2019s templating engine.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#id2)*",
              "key": "Optional",
              "schema": {
                "extends": [
                  "api.KEY_VALUE_SCHEMA"
                ]
              },
              "type": "schema"
            },
            "id": {
              "key": "GeneratedID",
              "type": "use_id",
              "use_id_type": "api::APIServer"
            },
            "service": {
              "key": "Optional",
              "templatable": true,
              "type": "string"
            },
            "variables": {
              "default": "{}",
              "docs": "**, mapping**: Optional variables that can be used in the `data_template`. Values are [lambdas](https://esphome.io/automations/templates.html#config-lambda) and will be evaluated before sending the request.\n\n*See also: [Native API Component](https://esphome.io/components/api.html#id2)*",
              "key": "String",
              "key_type": "string",
              "schema": {
                "config_vars": {
                  "string": {}
                }
              },
              "type": "schema"
            }
          }
        },
        "type": "schema"
      },
      "KEY_VALUE_SCHEMA": {
        "key": "String",
        "key_type": "string",
        "schema": {
          "config_vars": {
            "string": {
              "templatable": true,
              "type": "string"
            }
          }
        },
        "type": "schema"
      }
    }
  }
}